---
title: Registry API
description: Access Windows Registry values in Novadesk
---

import CodeBlock from '@theme/CodeBlock';
import {Method, MethodParam} from '@site/src/components/Method';
import Admonition from '@theme/Admonition';

<Admonition type="warning">
The `system` object is **only available in the Main script**. UI scripts should communicate with the main script via [IPC](/api/widget-api/widget-methods/#inter-process-communication-ipc) if they need system data.
</Admonition>

The Registry API provides methods to read and write Windows Registry keys.

---

<Method signature="system.readRegistry(path, valueName)"
  description="Reads a value from the Windows Registry.">
  <MethodParam name="path" type="string">
    Full path to the registry key. Must start with a root key: `HKCU`, `HKLM`, `HKCR`, or `HKU`.
    - Example: `HKCU\\Software\\Novadesk`
  </MethodParam>
  <MethodParam name="valueName" type="string">
    The name of the value to read. Use an empty string for the (Default) value.
  </MethodParam>
</Method>

### Return Value
* **Type**: `string | number | null`
* **Description**: Returns the value data if successful. Supports `REG_SZ`, `REG_EXPAND_SZ`, and `REG_DWORD`. Returns `null` if the key or value does not exist.

---

<Method signature="system.writeRegistry(path, valueName, data)"
  description="Writes a value to the Windows Registry. Creates the key if it doesn't exist.">
  <MethodParam name="path" type="string">
    Same as `readRegistry`.
  </MethodParam>
  <MethodParam name="valueName" type="string">
    Same as `readRegistry`.
  </MethodParam>
  <MethodParam name="data" type="string | number">
    Data to write. Strings are written as `REG_SZ`, numbers as `REG_DWORD`.
  </MethodParam>
</Method>

### Return Value
* **Type**: `boolean`
* **Description**: `true` if successful.

---

### Examples

<CodeBlock language="javascript">
  {`// Read a value
var theme = system.readRegistry("HKCU\\Software\\Novadesk", "Theme");
if (theme) {
    console.log("Current Theme: " + theme);
}

// Write a value
system.writeRegistry("HKCU\\Software\\Novadesk", "LastRun", new Date().toString());`}
</CodeBlock>